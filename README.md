# CMAPSS FD001 RUL Predict Script

This project provide a train and predict script for NASA CMAPSS FD001 Turbo Fan dataset, support some of machine learn models including `RNN`, `LSTM`, `Transformer`, `oTransformer`, `GNN+LSTM`, and `Learnable GNN+LSTM`.

## File structure and dataset
- `train_rul_fd001.py`: Trainning script
- `data/`: FD001 dataset file folder
- `artifacts/`: Model weight folder
- `outputs/`: Trainning curve and result folder
- `LearnableAdjGNNLSTMRegressor.py`: Learnable GNN+LSTM module
- `Olinear.py`: Orthogonality linear module
- `Otransformer.py`: Orthogonality transformer module


## Dependency Installation

```
pip install pandas numpy scikit-learn matplotlib seaborn torch tqdm
```

## How to use
- Train all models
```
python train_rul_fd001.py --data_dir data/ --models all --epochs 20 --seq_len 30 --batch_size 128
```

- Train Transformer
```
python train_rul_fd001.py --data_dir data --models transformer --epochs 15 --seq_len 50
```

- Using GNN to train
```
python train_rul_fd001.py --data_dir data/ --models gnn --epochs 20 --seq_len 30 --gnn_corr_thr 0.3 --gnn_node_dim 32 --gnn_lstm_hidden 64 --gnn_lstm_layers 2
```

After train：
- model weights will save in `artifacts/` folder.
- Trainning loss curve will save with its json data in  `outputs/*_loss.png`.
- Test predict result will save in `outputs/*_test_preds.csv`.
- Estimate relate graphs and data will save in `outputs/test_scatter.png`, `outputs/test_residuals.png`, `outputs/test_metrics_bar.png`, `outputs/metrics.json`.

## Parameter（CLI）
- `--data_dir`：dataset path,default is `data`.
- `--seq_len`：sequence length
- `--batch_size`：train batch
- `--epochs`：train epoch
- `--lr`：learning rate, default is `1e-3`.
- `--val_ratio`：validation percentage, default is `0.2`.
- `--models`：choose training model,including `all | rnn | lstm | transformer | gnn`.
- `--save_dir`：model save path,default is `artifacts`.
- `--out_dir`：output graphs and data path,default is `outputs`.
- `--seed`：random seed,default is `42`.
- `--device`：choosing training devices, if you have nvidia gpu, you can use `cuda`, otherwise, please use `auto`.
- `--sensor_set`：choose sensor columns, including `paper | all | auto`, default is `paper`, from reference journal.
- `--scaler`：scaler method, `zscore | minmax`, default is `zscore`.
- `--rul_max`：sperate rul amount, default is `130`.
- `--gnn_corr_thr`：Thresholds of Pearson correlation,default is `0.3`.
- `--gnn_node_dim`：GCN node's dimension
- `--gnn_lstm_hidden`：LSTM hide dimension after GCN.
- `--gnn_lstm_layers`：LSTM layers after GCN.



## Copyrights
No additional copyrights.

## Disclaimer
Some of this repo's codes are generated by AI.
